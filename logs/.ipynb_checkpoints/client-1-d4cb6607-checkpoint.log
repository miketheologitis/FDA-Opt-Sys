[93mWARNING [0m:   DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
08:34:48 - DEPRECATED FEATURE: flwr.client.start_client() is deprecated.
	Instead, use the `flower-supernode` CLI command to start a SuperNode as shown below:

		$ flower-supernode --insecure --superlink='<IP>:<PORT>'

	To view all available options, run:

		$ flower-supernode --help

	Using `start_client()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
08:34:48 - Opened insecure gRPC connection (no certificates were passed)
08:34:48 - ChannelConnectivity.IDLE
08:34:48 - ChannelConnectivity.CONNECTING
08:34:48 - ChannelConnectivity.READY
[92mINFO [0m:      
08:34:48 - 
[92mINFO [0m:      Received: train message 925949d4-2cf2-4c8c-91ce-228374df7fdd
08:34:48 - Received: train message 925949d4-2cf2-4c8c-91ce-228374df7fdd
[91mERROR [0m:     Client raised an exception.
Traceback (most recent call last):
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/app.py", line 572, in start_client_internal
    reply_message = client_app(message=message, context=context)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mtheologitis/FDA-Opt-Sys/fdaopt/client.py", line 54, in fit
    train_fda(self.model, self.optimizer, self.trainloader, self.device, self.local_epochs, self.client_id, push_to_server_socket, pull_variance_approx_socket, sketch)
  File "/home/mtheologitis/FDA-Opt-Sys/fdaopt/training.py", line 108, in train_fda
    send_number_matrix(push_to_server_socket, client_id, norm_sq_drift, sketch)
  File "/home/mtheologitis/FDA-Opt-Sys/fdaopt/networking.py", line 26, in send_number_matrix
    push_socket.send_json(msg)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/zmq/sugar/socket.py", line 991, in send_json
    msg = jsonapi.dumps(obj, **kwargs)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/zmq/utils/jsonapi.py", line 25, in dumps
    return json.dumps(o, **kwargs).encode("utf8")
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
08:34:52 - Client raised an exception.
Traceback (most recent call last):
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/app.py", line 572, in start_client_internal
    reply_message = client_app(message=message, context=context)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mtheologitis/FDA-Opt-Sys/fdaopt/client.py", line 54, in fit
    train_fda(self.model, self.optimizer, self.trainloader, self.device, self.local_epochs, self.client_id, push_to_server_socket, pull_variance_approx_socket, sketch)
  File "/home/mtheologitis/FDA-Opt-Sys/fdaopt/training.py", line 108, in train_fda
    send_number_matrix(push_to_server_socket, client_id, norm_sq_drift, sketch)
  File "/home/mtheologitis/FDA-Opt-Sys/fdaopt/networking.py", line 26, in send_number_matrix
    push_socket.send_json(msg)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/zmq/sugar/socket.py", line 991, in send_json
    msg = jsonapi.dumps(obj, **kwargs)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/zmq/utils/jsonapi.py", line 25, in dumps
    return json.dumps(o, **kwargs).encode("utf8")
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
08:34:53 - gRPC channel closed
Traceback (most recent call last):
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/mtheologitis/FDA-Opt-Sys/fdaopt/client.py", line 207, in <module>
    start_client(
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/app.py", line 200, in start_client
    start_client_internal(
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/app.py", line 579, in start_client_internal
    raise ex
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/app.py", line 572, in start_client_internal
    reply_message = client_app(message=message, context=context)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/home/mtheologitis/FDA-Opt-Sys/fdaopt/client.py", line 54, in fit
    train_fda(self.model, self.optimizer, self.trainloader, self.device, self.local_epochs, self.client_id, push_to_server_socket, pull_variance_approx_socket, sketch)
  File "/home/mtheologitis/FDA-Opt-Sys/fdaopt/training.py", line 108, in train_fda
    send_number_matrix(push_to_server_socket, client_id, norm_sq_drift, sketch)
  File "/home/mtheologitis/FDA-Opt-Sys/fdaopt/networking.py", line 26, in send_number_matrix
    push_socket.send_json(msg)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/zmq/sugar/socket.py", line 991, in send_json
    msg = jsonapi.dumps(obj, **kwargs)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/site-packages/zmq/utils/jsonapi.py", line 25, in dumps
    return json.dumps(o, **kwargs).encode("utf8")
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/mtheologitis/anaconda3/envs/flower/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
